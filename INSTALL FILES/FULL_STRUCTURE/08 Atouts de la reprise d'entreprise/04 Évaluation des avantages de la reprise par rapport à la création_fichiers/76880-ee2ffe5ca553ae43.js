(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[76880],{77789:(e,t,n)=>{"use strict";n.d(t,{b:()=>d,u:()=>m});var r=n(92177),l=n(63927),i=n(60720),s=n(75526),o=n(68635),a=n(9877),c=n(99116);let d=e=>{var t;let{commentsType:n,lastCommentId:r,pageId:s,parentId:o,sortOption:d,targetCommentId:m}=e,u=new URLSearchParams,p=c.i[n],v=m?"".concat(l.cm,"/focus"):l.cm,{sortBy:h,sortOrder:x}=(0,a.U4)(d);return u.set("pagination[limit]","10"),u.set("pagination[parent][sortOrder]",x),u.set("pagination[children][sortOrder]",i.e.ASC),u.set("pagination[parent][sortBy]",h),u.set("parent",null!==(t=null==o?void 0:o.toString())&&void 0!==t?t:"null"),u.set(p,s.toString()),m&&u.set("commentId",m.toString()),0!==r&&u.set("pagination[cursor]",r.toString()),"".concat(v,"?").concat(u.toString())},m=e=>{let{parentId:t,commentsType:n,pageId:l,lastCommentId:i,sortOption:a,targetCommentId:c,config:m}=e,{fetcher:u}=(0,s.e)({method:o.Z.get});return(0,r.Ay)(d({parentId:t,commentsType:n,pageId:l,lastCommentId:i,sortOption:a,targetCommentId:c}),u,m)}},99777:(e,t,n)=>{"use strict";n.d(t,{P:()=>c});var r=n(74848),l=n(96540),i=n(50991),s=n(13189),o=n(15253),a=n.n(o);let c=e=>{let{attributes:t,children:n,element:o}=e,{ref:c,hovered:d}=(0,s.M)(),[m,u]=l.useState(null),[p,v]=l.useState(null),{styles:h,attributes:x}=(0,i.E)(m,p,{placement:"top-start",strategy:"fixed"}),f=(0,l.useCallback)(e=>{c.current=e,u(e)},[u]);return(0,r.jsxs)("span",{ref:f,children:[(0,r.jsxs)("span",{...t,className:a().CommentMention,contentEditable:!1,"data-cy":"mention-".concat(o.displayName.replace(" ","-")),"data-avatar-url":o.profileImageUrl||"","data-id":o.id||0,children:["@",o.displayName,n]}),d&&(0,r.jsx)("div",{ref:v,style:{zIndex:100,...h.popper},...x,contentEditable:!1,children:(0,r.jsxs)("div",{className:a().CommentMentionPopover,children:[o.profileImageUrl&&(0,r.jsx)("img",{className:a().CommentMentionPopoverUserAvatar,src:o.profileImageUrl,width:46,height:46,alt:o.displayName}),(0,r.jsx)("p",{className:a().CommentMentionPopoverDisplayName,children:o.displayName})]})})]})}},80015:(e,t,n)=>{"use strict";n.d(t,{B:()=>ep});var r=n(74848),l=n(96540),i=n(15507),s=n(57746),o=n(69162),a=n(69101),c=n(59184),d=n(50856),m=n(19517),u=n(17266),p=n(37477);let v=e=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"14px",...e,children:(0,r.jsx)("path",{fill:"currentColor",d:"M511.1 255.1c0 12.8-7.625 24.38-19.41 29.41L44.6 477.4c-4.062 1.75-8.344 2.594-12.59 2.594c-8.625 0-17.09-3.5-23.28-10.05c-9.219-9.766-11.34-24.25-5.344-36.27l73.66-147.3l242.1-30.37L77.03 225.6l-73.66-147.3C-2.623 66.3-.4982 51.81 8.72 42.05c9.25-9.766 23.56-12.75 35.87-7.453L492.6 226.6C504.4 231.6 511.1 243.2 511.1 255.1z"})});var h=n(53285),x=n(59249),f=n(25489),g=n(8682),C=n(39419),y=n(88232),j=n(50991),b=n(21576),_=n(8583),I=n(70530),w=n.n(I);let E=e=>{let{optionsLength:t,activeIndex:n,setActiveIndex:r,selectOption:i,options:s,listRef:o}=e,a=(0,l.useCallback)(e=>{switch(e.key){case"Up":case"ArrowUp":e.preventDefault(),r(e=>{let n=e>0?e-1:t-1;return k(n,o),n});return;case"Down":case"ArrowDown":e.preventDefault(),r(e=>{let n=e<t-1?e+1:0;return k(n,o),n});return;case"Enter":case" ":e.preventDefault(),i(s[n].value);return;case"Esc":case"Escape":e.preventDefault(),i(!1);return;case"PageUp":case"Home":e.preventDefault(),r(0),k(0,o);return;case"PageDown":case"End":e.preventDefault(),r(t-1),k(t-1,o);return}},[n,t,r,i,s,o]);(0,l.useEffect)(()=>(document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)),[a])},k=(e,t)=>{let n=t.current;if(n){let t=n.children[e],r=t.offsetTop,l=r+t.clientHeight,i=n.clientHeight;r<n.scrollTop?n.scrollTop=r-80:l>n.scrollTop+i&&(n.scrollTop=l+80-i)}},N=e=>{let{setIsDropdownOpen:t}=e,n=(0,l.useCallback)(e=>{["ArrowUp","ArrowDown","Enter"," "].includes(e.key)&&(e.preventDefault(),t(!0))},[t]);(0,l.useEffect)(()=>(document.addEventListener("keydown",n),()=>document.removeEventListener("keydown",n)),[n])},S=e=>{let{options:t,onChange:n}=e,[r,i]=(0,l.useState)(!1),[s,o]=(0,l.useState)(0),a=(0,l.useRef)(null),c=(0,l.useCallback)(e=>{e&&n(e),i(!1)},[n]);return E({optionsLength:t.length,activeIndex:s,setActiveIndex:o,selectOption:c,options:t,listRef:a}),N({setIsDropdownOpen:i}),(0,l.useEffect)(()=>{r&&a.current&&(0,_.n)()?requestAnimationFrame(()=>{var e;return null===(e=a.current)||void 0===e?void 0:e.focus()}):a.current&&(0,_.n)()&&requestAnimationFrame(()=>{var e,t;return null===(t=a.current)||void 0===t?void 0:null===(e=t.previousSibling)||void 0===e?void 0:e.focus()})},[r]),{isDropdownOpen:r,setIsDropdownOpen:i,activeIndex:s,setActiveIndex:o,selectOption:c,listRef:a}},A=e=>{let{options:t,onChange:n}=e,{setIsDropdownOpen:i,activeIndex:s,setActiveIndex:o,selectOption:a,listRef:c}=S({options:t,onChange:n});return(0,l.useEffect)(()=>{i(!0)},[i]),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("ul",{ref:c,className:w().SelectDropdown,role:"listbox",children:t.map((e,t)=>{let{label:n,value:l}=e;return(0,r.jsx)("li",{id:"select_option_".concat(l),role:"option","aria-selected":t===s,onMouseOver:()=>o(t),onClick:()=>a(Number(l)),children:(0,r.jsxs)("label",{children:[(0,r.jsx)("input",{type:"radio",name:"select_radio",value:l,onChange:()=>a(t)}),(0,r.jsx)("span",{children:n})]})},l)})})})};var L=n(35640),P=n.n(L);let R=e=>e.map(e=>({value:e.userId.toString(),label:(0,r.jsxs)("div",{className:P().Suggestion,children:[e.profileImageUrl&&(0,r.jsx)("img",{className:P().Avatar,width:20,height:20,src:e.profileImageUrl,alt:"Avatar of ".concat(e.displayName)}),(0,r.jsx)("strong",{className:P().DisplayName,children:e.displayName})]})})),T=e=>{let{target:t,editor:n,items:s,onSelect:o,isLoading:a}=e,[c,d]=(0,l.useState)([]),[m,u]=l.useState(null),[p,v]=l.useState(null),{styles:h,attributes:x}=(0,j.E)(m,p,{placement:"top-start",modifiers:[{name:"offset",options:{offset:[0,20]}}]}),f=(0,l.useRef)(u);return((0,l.useEffect)(()=>{t&&s.length>0&&d(R(s))},[t,s]),(0,l.useEffect)(()=>{if(t){let e=document.createElement("div");document.body.appendChild(e),f.current(e);let r=i.rL.toDOMRange(n,t).getBoundingClientRect();return e.style.position="absolute",e.style.top="".concat(r.bottom+window.pageYOffset,"px"),e.style.left="".concat(r.left+window.pageXOffset,"px"),()=>{document.body.removeChild(e),f.current(null)}}},[t,n]),t)?(0,r.jsx)("div",{ref:u,children:(0,r.jsx)("div",{ref:v,style:{zIndex:100,...h.popper},...x.popper,children:(0,r.jsx)("div",{className:P().Popper,children:!a||s.length>0?(0,r.jsx)(A,{options:c,onChange:e=>{let t=s.find(t=>t.userId===Number(e));t&&o(t)}}):(0,r.jsx)("div",{className:P().LoaderContainer,children:(0,r.jsx)(b.a,{type:"light"})})})})}):null},F=e=>{let{attributes:t,element:n,children:l}=e;return(0,r.jsx)("a",{...t,href:n.url,children:l})};var D=n(99777);let M=e=>{let{attributes:t,children:n,element:l}=e;switch(l.type){case"link":return(0,r.jsx)(F,{...e});case"mention":return(0,r.jsx)(D.P,{attributes:t,element:l,children:n});default:return(0,r.jsx)("p",{className:"relative",...t,children:n})}},B=e=>{let{attributes:t,children:n,leaf:l}=e;return l.bold&&(n=(0,r.jsx)("strong",{children:n})),l.italic&&(n=(0,r.jsx)("em",{children:n})),l.underline&&(n=(0,r.jsx)("u",{children:n})),(0,r.jsx)("span",{...t,children:n})},K=e=>{let{isInline:t}=e;return e.isInline=e=>"link"===e.type||t(e),e},z=e=>{let{isInline:t,isVoid:n}=e;return e.isInline=e=>"mention"===e.type||t(e),e.isVoid=e=>"mention"===e.type||n(e),e};var O=n(47709),U=n(44388),Z=n(20186),H=n(97366),Q=n(99116),V=n(35839),X=n(140),W=n(69724),Y=n(67561),q=n(61038);let $=e=>{let{setLinkIsEditing:t}=e,n=(0,i.Zi)(),l=(0,Y._)(n,"link");return(0,r.jsx)(W.I,{format:l?"unlink":"link",active:l,onClick:()=>{l?(0,q.wk)(n):t(!0)},children:l?(0,r.jsx)(X.A,{className:(0,d.QP)("size-5 text-[#8995b0b3] md:size-6",l&&"text-[initial]")}):(0,r.jsx)(V.A,{className:(0,d.QP)("size-5 text-[#8995b0b3] md:size-6",l&&"text-[initial]")})})};var J=n(30044),G=n(27930),ee=n(86248),et=n(70996),en=n(3810),er=n(14947);let el=e=>{let{linkIsEditing:t,setLinkIsEditing:n}=e,{t:s}=(0,o.Bd)(),a=(0,i.Zi)(),[c,d]=(0,l.useState)(""),m=()=>{c&&(0,q.Ck)(a,c),n(!1),d("")},u=()=>{n(!1),d("")};return(0,r.jsxs)(J.lG,{className:"fixed z-20",open:t,onClose:u,children:[(0,r.jsx)(G._,{as:l.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)("div",{className:"fixed inset-0 bg-black/60 transition-opacity"})}),(0,r.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,r.jsx)("div",{className:"flex min-h-full w-full items-center justify-center text-center",children:(0,r.jsxs)("div",{className:"relative w-full max-w-screen-sm",children:[(0,r.jsx)("button",{className:"absolute right-0 top-0 z-[1001] ml-[15px] hidden items-center justify-center sm:flex md:top-5 md:mt-11",onClick:u,children:(0,r.jsx)(er.A,{className:"fill-white"})}),(0,r.jsx)(G._,{as:l.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,r.jsx)(J.Lj,{className:"relative w-full p-2 text-left transition-all sm:w-[calc(100%-40px)] md:mt-16 md:min-h-fit md:rounded-lg md:p-0",children:(0,r.jsxs)("div",{className:"flex flex-col items-start gap-3.5 rounded-md bg-white p-5 sm:gap-8",children:[(0,r.jsx)("p",{className:"text-base font-bold text-darkblue sm:text-2xl",children:s("comments.components.comments.add_link_title")}),(0,r.jsx)(et.A,{className:"w-full",placeholder:s("comments.components.comments.link_menu_placeholder"),onKeyDown:e=>{"Enter"===e.key&&m()},value:c,onChange:e=>d(e.target.value)}),(0,r.jsxs)("div",{className:"flex w-full items-center justify-end gap-2.5",children:[(0,r.jsx)(ee.tA,{className:"w-full px-7 sm:w-fit",onClick:u,children:s("comments.components.comments.add_link_cancel")}),(0,r.jsx)(en.A,{className:"w-full p-1 px-8 sm:w-fit",onClick:m,children:s("comments.components.comments.add_link_save")})]})]})})})]})})})]})},ei=function(e){return(0,r.jsx)("svg",{width:"22",height:"22",viewBox:"0 0 22 22",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,r.jsx)("path",{d:"M10.9968 0C13.915 0 16.7137 1.15893 18.7772 3.22183C20.8407 5.28473 22 8.08262 22 11C22 14.7208 20.4293 17.1875 17.8738 17.1875C16.1876 17.1875 14.9304 16.1136 14.2703 14.3138C13.4505 15.6654 12.0724 16.5 10.3091 16.5C7.36574 16.5 5.4952 14.1721 5.4952 11C5.4952 7.78663 7.3011 5.5 10.3091 5.5C11.756 5.5 12.9237 6.02938 13.7476 6.9355V6.1875C13.7473 6.0157 13.8113 5.85001 13.9271 5.72305C14.0429 5.59609 14.202 5.51707 14.3732 5.50155C14.5443 5.48602 14.7151 5.53512 14.8518 5.63918C14.9886 5.74323 15.0814 5.8947 15.112 6.06375L15.123 6.1875V11C15.123 14.0566 16.2412 15.8125 17.8738 15.8125C19.5064 15.8125 20.6246 14.0566 20.6246 11C20.624 8.95387 19.9711 6.96117 18.7608 5.31114C17.5505 3.66111 15.8456 2.43961 13.8937 1.82394C11.9419 1.20827 9.84452 1.23047 7.90612 1.88731C5.96772 2.54416 4.28913 3.80146 3.11401 5.47674C1.93889 7.15201 1.32838 9.15808 1.3711 11.2038C1.41381 13.2495 2.10753 15.2283 3.35156 16.8531C4.59558 18.4779 6.32519 19.6641 8.28932 20.2395C10.2535 20.8149 12.3499 20.7496 14.2744 20.053C14.4444 19.9969 14.6296 20.0093 14.7906 20.0876C14.9516 20.1658 15.0757 20.3037 15.1366 20.472C15.1975 20.6403 15.1903 20.8257 15.1167 20.9888C15.043 21.1519 14.9086 21.2799 14.742 21.3455C13.2322 21.8908 11.6213 22.0993 10.0223 21.9562C8.42332 21.8131 6.87504 21.322 5.48606 20.5173C4.09709 19.7126 2.90108 18.6138 1.98195 17.298C1.06281 15.9821 0.442816 14.4812 0.165461 12.9004C-0.111894 11.3197 -0.0398901 9.6974 0.376421 8.14742C0.792732 6.59743 1.54327 5.15728 2.57536 3.92802C3.60746 2.69876 4.89612 1.71017 6.35092 1.0316C7.80573 0.353036 9.39144 0.000933696 10.9968 0ZM10.3091 6.875C8.14147 6.875 6.8706 8.48375 6.8706 11C6.8706 13.4709 8.19924 15.125 10.3091 15.125C12.419 15.125 13.7476 13.4709 13.7476 11C13.7476 8.48375 12.4767 6.875 10.3091 6.875Z",fill:"currentColor"})})},es=(e,t,n)=>{n&&a.gB.select(e,n);let r={type:"mention",displayName:t.displayName,id:t.id,profileImageUrl:t.profileImageUrl,children:[{text:""}]};a.gB.insertNodes(e,r),a.gB.move(e,{unit:"offset"}),a.gB.insertNodes(e,{text:" "})},eo=e=>{let[t]=a.KE.nodes(e,{match:e=>!a.KE.isEditor(e)&&a.Hg.isElement(e)&&"mention"===e.type});return!!t},ea=e=>{let{onClick:t}=e,n=eo((0,i.Zi)());return(0,r.jsx)(W.I,{active:n,format:"mention",onClick:t,children:(0,r.jsx)(ei,{className:"size-5 text-[#8995b0b3] hover:text-[initial] md:size-6"})})};var ec=n(84074);let ed=(e,t)=>{a.gB.insertNodes(e,{text:t})},em=e=>{if(a.EY.isText(e)){let t=(0,ec.sanitize)(e.text);return e.underline&&(t=t.trim()?"<u>".concat(t,"</u>"):""),e.italic&&(t=t.trim()?"<em>".concat(t,"</em>"):""),e.bold&&(t=t.trim()?"<strong>".concat(t,"</strong>"):""),t}let t=e.children.map(e=>em(e)).join("");switch(e.type){case"paragraph":return t.trim()?"<p>".concat(t,"</p>"):"<br>";case"link":return t.trim()?'<a href="'.concat(e.url,'" target="_blank">').concat(t,"</a>"):"";case"mention":return e.displayName.trim()?"<@".concat(e.id,":").concat(e.displayName,">"):"";default:return t}},eu=e=>{let{path:t,className:n=""}=e,s=(0,i.Zi)(),[o,a]=(0,l.useState)(!1),c=()=>{ed(s,"@"),i.rL.focus(s)};return(0,r.jsxs)("div",{className:(0,d.QP)("flex items-center gap-2 md:gap-3",n),onClick:e=>e.stopPropagation(),children:[(0,r.jsx)(Z.A,{className:"group",iconClassName:"size-5 text-lightgray group-hover:text-darkblue md:size-6"}),(0,r.jsx)(O.A,{iconClassName:"size-5 md:size-6"}),(0,r.jsx)(U.u,{iconClassName:"text-lightgray size-5 md:size-6 hover:text-darkblue"}),!o&&(0,r.jsxs)(r.Fragment,{children:[Q.m.map(e=>{switch(e.type){case"link":return(0,r.jsx)($,{setLinkIsEditing:a},e.id);case"mention":return t&&(0,r.jsx)(ea,{onClick:c},e.id);default:return(0,r.jsx)("div",{})}}),(0,r.jsx)(H.p,{iconClassName:"size-5 md:size-6",onEmojiSelect:e=>{ed(s,e.native),i.rL.focus(s)}})]}),(0,r.jsx)(el,{setLinkIsEditing:a,linkIsEditing:o})]})},ep=e=>{var t;let{handleAddComment:n,setActiveComment:j,isRoot:b,initialValue:_,mode:I=f.lX.Add,onCancel:w,className:E="",editableComment:k}=e,{user:N}=(0,p.Ay)(),{t:S}=(0,o.Bd)(),{extra:A}=(0,y.DP)(),[L,P]=(0,l.useState)(""),[R,F]=(0,l.useState)(!1),D=(0,l.useMemo)(()=>(0,i.o$)((0,c.$k)(K(z((0,a.ie)())))),[]),{attachments:O,isUploading:U}=(0,h.N)(),[Z,H]=(0,l.useState)(null),[Q,V]=(0,l.useState)(""),[X]=(0,u.o)(Q,300),W=(0,m.L)(()=>F(!1)),Y=R||L&&"<br>"!==L,q=(0,g.E)(A),$=(0,C.Z)({communityPath:q?A.community.communityPath:void 0,postId:q?A.community.postId:void 0,displayNameSearchBy:X}),[J,G]=(0,l.useState)(_||[{type:"paragraph",children:[{text:""}]}]),ee=(0,l.useCallback)(e=>(0,r.jsx)(M,{...e}),[]),et=(0,l.useCallback)(e=>(0,r.jsx)(B,{...e}),[]),en=()=>{if(w)return w();j(null)};(0,l.useEffect)(()=>{let e=em(D);e?P(e):P("")},[J]);let er=e=>{Z&&(es(D,{displayName:e.displayName,id:e.userId,profileImageUrl:e.profileImageUrl},Z),H(null),i.rL.focus(D))};return(0,l.useEffect)(()=>{if(!k)return;let e=e=>{"Escape"===e.key&&en()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[k]),(0,r.jsx)(i.A,{editor:D,initialValue:J,onChange:e=>{G(e);let{selection:t}=D;if(t&&a.Q6.isCollapsed(t)){let[e]=a.Q6.edges(t),n=a.KE.before(D,e,{unit:"word"}),r=n&&a.KE.before(D,n),l=r&&a.KE.range(D,r,e),i=l&&a.KE.string(D,l),s=i&&i.match(/(?:^|\s)@([^\s@]*)(\s|$)/),o=a.KE.after(D,e),c=a.KE.range(D,e,o),d=a.KE.string(D,c).match(/^(\s|$)/),m=n&&a.KE.before(D,{...n,offset:n.offset},{unit:"character",distance:2}),u=m&&a.KE.range(D,m,e),p=u&&a.KE.string(D,u),v=new RegExp(/(?:^|\s)@/).test(p||"");if((null==s?void 0:s[1])&&d&&v){H(l||u||null),V(s[1]);return}{let t=a.KE.before(D,e,{distance:2}),n=t&&a.KE.range(D,t,e),r=n&&a.KE.string(D,n),i=a.KE.before(D,e),s=i&&a.KE.range(D,i,e);if(" @"===r||"@"===r){H(s||n||l||null),V("");return}}}H(null)},children:(0,r.jsxs)("div",{className:E,children:[(0,r.jsxs)("div",{className:"flex flex-row items-start gap-2.5 sm:gap-2.5",children:[(0,p.NP)(N)&&(0,r.jsx)("img",{className:"mt-2 size-10 rounded-full",src:N.avatarUrl}),(0,r.jsxs)("div",{ref:W,className:(0,d.QP)("relative w-[calc(100%-40px)] min-w-0 grow-0 cursor-text rounded-xl border border-transparent bg-[#F0F3F6] p-3 transition-all duration-200",(Y||I===f.lX.Edit)&&"p-5 pb-12 pr-14","has-[:focus-visible]:border-blue"),onClick:()=>{R&&i.rL.isFocused(D)||i.rL.focus(D)},children:[(0,r.jsx)(i.Fo,{className:"peer text-darkblue focus-visible:outline-none [&_a:hover]:underline [&_a]:text-[#2e6ef4] [&_a]:no-underline",placeholder:S("comments.components.comments.input_placeholder_label"),renderElement:ee,renderLeaf:et,style:{whiteSpace:"break-spaces"},onKeyDown:e=>{let{selection:t}=D;if(t&&a.Q6.isCollapsed(t)){let{nativeEvent:t}=e;if((0,s.Sn)("left",t)){e.preventDefault(),a.gB.move(D,{unit:"offset",reverse:!0});return}if((0,s.Sn)("right",t)){e.preventDefault(),a.gB.move(D,{unit:"offset"});return}}},onFocus:()=>F(!0),scrollSelectionIntoView:()=>{}}),(0,r.jsx)(x.A,{className:(0,d.Id)(!!(null==O?void 0:O.length)&&"pt-4")}),(0,r.jsx)(eu,{className:(0,d.Id)("absolute bottom-2.5 left-3.5",!(Y||I===f.lX.Edit)&&"hidden"),path:q?A.community.communityPath:void 0}),(Y||I===f.lX.Edit)&&(0,r.jsxs)(r.Fragment,{children:[I!==f.lX.Edit&&!b&&(0,r.jsx)("button",{className:"absolute bottom-2.5 right-3.5 block cursor-pointer text-sm text-blue hover:text-blue-300 md:hidden",onClick:en,children:S("comments.components.comments.cancel_label")}),(0,r.jsx)("button",{className:"absolute right-6 top-5 flex size-6 items-center justify-center text-blue disabled:text-lightgray-100",onClick:()=>{L&&(n(L,O),I!==f.lX.Edit&&(a.gB.select(D,a.KE.start(D,[])),D.history={redos:[],undos:[]},D.children=[{type:"paragraph",children:[{text:""}]}]))},disabled:!L||"<br>"===L||U,children:(0,r.jsx)(v,{className:"size-5 md:size-6"})})]}),q&&A.community.communityPath&&Z&&($.isLoading||!!(null===(t=$.data)||void 0===t?void 0:t.length))&&(0,r.jsx)(T,{target:Z,editor:D,items:$.data||[],isLoading:$.isLoading,onSelect:e=>er(e)})]})]}),(!b||I===f.lX.Edit)&&(0,r.jsx)("button",{onClick:en,className:"ml-12 hidden cursor-pointer pt-2.5 text-sm text-darkblue/50 transition-colors hover:text-darkblue md:inline-block",dangerouslySetInnerHTML:{__html:S("comments.components.comments.cancel_label_or_esc")}}),I===f.lX.Edit&&(0,r.jsx)("div",{className:"mt-2.5 flex items-center justify-end",children:(0,r.jsx)("button",{className:"z-[1] flex min-h-[36px] w-auto min-w-[80px] cursor-pointer select-none items-center justify-end self-center rounded bg-blue px-5 text-center text-sm font-bold text-white outline-0 md:hidden",onClick:en,children:S("comments.components.comments.cancel_label")})})]})})}},95759:(e,t,n)=>{"use strict";n.d(t,{M:()=>eg});var r=n(74848),l=n(96540),i=n(69162),s=n(50856),o=n(33225),a=n(53285),c=n(59249),d=n(53616),m=n(63927),u=n(95336),p=n(75526),v=n(68635);let h=e=>{let{commentId:t,config:n}=e,{fetcher:r}=(0,p.e)({method:v.Z.post});return(0,d.A)("".concat(m.cm,"/").concat(t,"/like"),(0,u.u)(r),n)},x=e=>{let{commentId:t,config:n}=e,{fetcher:r}=(0,p.e)({method:v.Z.delete});return(0,d.A)("".concat(m.cm,"/").concat(t,"/like"),(0,u.u)(r),n)},f=e=>{let{commentId:t,config:n}=e,{fetcher:r}=(0,p.e)({method:v.Z.put});return(0,d.A)("".concat(m.cm,"/").concat(t),(0,u.u)(r),n)};var g=n(13189),C=n(50991),y=n(21576),j=n(92177);let b=e=>"".concat(m.cm,"/").concat(e,"/last_likes"),_=e=>{let{commentId:t,config:n}=e,{fetcher:r}=(0,p.e)({method:v.Z.get});return(0,j.Ay)(b(t),r,n)};var I=n(94156),w=n.n(I);let E=e=>{var t;let{likesCount:n,referenceElement:s,commentId:o,onError:a}=e,{t:c}=(0,i.Bd)(),[d,m]=(0,l.useState)(null),{styles:u,attributes:p}=(0,C.E)(s,d,{placement:"top",strategy:"fixed"}),v=_({commentId:o}),h=n>7?n-7:0;return(0,r.jsx)("div",{ref:m,style:u.popper,...p.popper,className:w().Popover,children:(0,r.jsx)("div",{className:w().PopoverBody,children:(0,r.jsx)("div",{className:w().PopoverContent,children:v.isLoading?(0,r.jsx)("div",{className:w().LoaderContainer,children:(0,r.jsx)(y.a,{small:!1,type:"light"})}):(0,r.jsxs)(r.Fragment,{children:[null===(t=v.data)||void 0===t?void 0:t.slice(0,7).map(e=>(0,r.jsx)("p",{className:w().PopoverLikeName,children:e.displayName},e.createdAt+e.displayName)),h>0&&(0,r.jsx)("p",{className:w().PopoverOverflowLikes,children:c("comments.components.comments.overflow_likes",{count:h})})]})})})})},k=function(e){return(0,r.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,r.jsx)("path",{d:"M3.05436 7.92627H3.8877C4.53203 7.92627 5.05436 8.4486 5.05436 9.09294V17.0096C5.05436 17.6539 4.53203 18.1763 3.8877 18.1763H3.05436C2.41003 18.1763 1.8877 17.6539 1.8877 17.0096V9.09294C1.8877 8.4486 2.41003 7.92627 3.05436 7.92627Z",stroke:"currentColor"}),(0,r.jsx)("path",{d:"M13.1958 3.81942L13.1958 3.81943L11.7529 7.66738L11.4995 8.34294H12.221H16.945C17.1132 8.34294 17.2794 8.37931 17.4323 8.44956C17.5851 8.51981 17.7209 8.62228 17.8305 8.74995C17.94 8.87761 18.0206 9.02745 18.0668 9.18919C18.113 9.35093 18.1237 9.52075 18.0981 9.687L17.053 16.4804C16.9803 16.9526 16.7411 17.3831 16.3785 17.6942C16.0159 18.0053 15.554 18.1763 15.0762 18.1763H8.05436C7.74494 18.1763 7.4482 18.0534 7.2294 17.8346C7.01061 17.6158 6.8877 17.319 6.8877 17.0096V8.55993C6.88769 8.18509 6.99303 7.81779 7.1917 7.49993L10.3655 2.42179L9.95364 2.16436L10.3655 2.42178C10.5081 2.19365 10.7064 2.00553 10.9417 1.87511C11.177 1.74469 11.4416 1.67627 11.7106 1.67627C11.9669 1.67627 12.2194 1.73838 12.4464 1.85728C12.6735 1.97618 12.8684 2.14833 13.0143 2.35899C13.1603 2.56965 13.2531 2.81255 13.2847 3.06689C13.3163 3.32123 13.2858 3.57944 13.1958 3.81942Z",stroke:"currentColor"})]})},N=e=>{let{commentId:t,readOnly:n,handleLikeClick:i,isLiked:s,likesCount:o,onError:a}=e,[c,d]=(0,l.useState)(null),{hovered:m,ref:u}=(0,g.M)();return(0,r.jsxs)("div",{className:w().LikeContainer,children:[(0,r.jsx)("button",{className:"".concat(w().LikeButton," ").concat(s?w().active:""),disabled:n,onClick:n?()=>{}:i,children:(0,r.jsx)(k,{width:20,height:20,className:w().LikeIcon})}),o>0&&(0,r.jsxs)("div",{ref:u,children:[(0,r.jsx)("span",{className:w().LikeCount,ref:d,children:o}),m&&(0,r.jsx)(E,{commentId:t,likesCount:o,referenceElement:c,onError:a})]})]})};var S=n(37458),A=n(27930),L=n(99269),P=n(62636),R=n(71069),T=n(74930),F=n(58427),D=n(27579),M=n(66104),B=n(23872),K=n(57574);let z=e=>{let{commentId:t,config:n}=e,{fetcher:r}=(0,p.e)({method:v.Z.delete});return(0,d.A)("".concat(m.cm,"/").concat(t),(0,u.u)(r),n)},O=e=>{let{commentId:t,config:n}=e,{fetcher:r}=(0,p.e)({method:v.Z.post,notFoundResponseHandler(){}});return(0,d.A)("".concat(m.cm,"/").concat(t,"/pin"),(0,u.u)(r),n)},U=e=>{let{commentId:t,config:n}=e,{fetcher:r}=(0,p.e)({method:v.Z.delete,notFoundResponseHandler(){}});return(0,d.A)("".concat(m.cm,"/").concat(t,"/pin"),(0,u.u)(r),n)};var Z=n(88232),H=n(47598),Q=n(8682),V=n(5150),X=n(22257),W=n(7415),Y=n(3307),q=n(70653);function $(e){return(0,r.jsx)(S.Dr,{className:(0,s.QP)("flex w-full cursor-pointer items-center gap-1.5 whitespace-nowrap px-5 py-2 text-start text-sm text-darkblue data-[focus]:text-darkblue/70",e.className),as:"button",onClick:e.onClick,children:e.children})}function J(e){let{onEdit:t,className:n,commentData:s}=e,{t:o}=(0,i.Bd)(),a=(0,L.S)(),{extra:c,commentsList:d,setComments:m,updateReplies:u,repliesList:p,pinnedComments:v,setPinnedComments:h,currentSortOption:x}=(0,Z.DP)(),f=z({commentId:s.id}),g=O({commentId:s.id}),C=U({commentId:s.id}),[y,j]=(0,l.useState)(!1),[b,_]=(0,l.useState)(!1),[I,w]=(0,l.useState)(!1),[E,k]=(0,l.useState)(!1),{canDeleteComment:N,canDeleteCommentAndBanAuthor:J,canUpdateComment:G,canPinComment:ee}=s,et=(0,Q.E)(c),en=N||G||J,er=ee&&Array.isArray(s.parent),el=async()=>{if(await f.trigger(),!f.error){if(s.parent&&!Array.isArray(s.parent)){var e;let t=s.parent.id;u({commentId:t,newReplies:null===(e=p[t].replies)||void 0===e?void 0:e.filter(e=>e.id!==s.id)}),s.isPinned?h(v.map(e=>e.id===t?{...e,totalReplies:e.totalReplies-1}:e)):m(d.map(e=>e.id===t?{...e,totalReplies:e.totalReplies-1}:e))}else s.isPinned?h((0,H.Hp)(v,s.id)):m((0,H.Hp)(d,s.id));et&&(0,R.j)((0,V.X)(c.community.communityPath,[c.community.postId]))}},ei=async()=>{await el().then(()=>{P.oR.success(o("comments.actions.delete_comment.success"))}).catch(e=>{a.error(e)})},es=async()=>{if(et){try{await el()}catch(e){return a.error(e)}await X.X3(c.community.communityPath,s.userId,y?{deleteRecentActivityOptions:{periodUnit:Y.i4.day,periodDuration:W.w}}:void 0),P.oR.success(o("comments.actions.delete_comment_and_ban_user.success"))}},eo=async()=>{await g.trigger().then(()=>{var e;m(e=>(0,H.Tv)((0,H.Hp)(e,s.id),{...v[0],isPinned:!1},(0,H.i$)(e,v[0],x))),h((0,H.Tv)((0,H.Hp)(v,null===(e=v[0])||void 0===e?void 0:e.id),{...s,isPinned:!0},null)),k(!1),P.oR.success(o("comments.actions.pin_comment.success"))}).catch(()=>P.oR.error(o("core.error.internal_error_message")))},ea=async()=>{v.length?k(!0):await g.trigger().then(()=>{m(e=>(0,H.Hp)(e,s.id)),h(e=>(0,H.Tv)(e,{...s,isPinned:!0},null)),P.oR.success(o("comments.actions.pin_comment.success"))}).catch(()=>P.oR.error(o("core.error.internal_error_message")))},ec=async()=>{await C.trigger().then(()=>{let e={...v[0],isPinned:!1};h([]),m(t=>{let n=(0,H.i$)(t,e,x);return(0,H.Tv)(t,e,n)}),P.oR.success(o("comments.actions.unpin_comment.success"))}).catch(()=>P.oR.error(o("core.error.internal_error_message")))};return en?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(S.W1,{children:[(0,r.jsx)(S.IU,{className:n,onClick:e=>e.stopPropagation(),children:(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)(B.A,{className:"size-8 rounded-full text-bluegray transition-colors duration-300 hover:bg-[#E6E6E6]"})})}),(0,r.jsx)(A.e,{as:l.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:(0,r.jsxs)(S.c,{as:"ul",anchor:{to:"bottom end",gap:10},className:"z-10 flex w-max min-w-[144px] max-w-sm translate-x-1 flex-col rounded-[10px] bg-white py-3 shadow-[0px_4px_10px_0px_#00000040]",onClick:e=>e.stopPropagation(),children:[N&&(0,r.jsxs)($,{onClick:()=>w(!0),children:[(0,r.jsx)(F.A,{className:"size-5 fill-darkblue group-hover:fill-darkblue/70"}),o("comments.actions.remove")]}),G&&(0,r.jsxs)($,{onClick:t,children:[(0,r.jsx)(D.A,{className:"size-5"}),o("comments.actions.edit")]}),J&&et&&(0,r.jsxs)($,{onClick:()=>_(!0),children:[(0,r.jsx)(K.A,{className:"size-5"}),o("comments.actions.remove_and_ban_user")]}),er&&((null==s?void 0:s.isPinned)?(0,r.jsxs)($,{onClick:ec,children:[(0,r.jsx)(M.A,{className:"size-5"}),o("comments.actions.unpin")]}):(0,r.jsxs)($,{onClick:ea,children:[(0,r.jsx)(M.A,{className:"size-5"}),o("comments.actions.pin")]}))]})})]}),b&&(0,r.jsx)(T.A,{onConfirm:es,onCloseModal:()=>_(!1),confirmationContent:(0,r.jsx)(q.q,{label:o("settings.form.delete_comment_and_ban_user_confirmation.label"),memberDisplayName:s.userName,checked:y,onCheck:()=>j(e=>!e)}),errorMessageMap:{unprocessableContentError:"community.error.error_user_already_banned"}}),I&&(0,r.jsx)(T.A,{onConfirm:ei,onCloseModal:()=>w(!1),confirmationContent:o("comments.components.comments.delete_confirmation_label")}),E&&(0,r.jsx)(T.A,{onConfirm:eo,onCloseModal:()=>k(!1),confirmationContent:o("comments.actions.switch_pin_comment.confirmation.content")})]}):null}var G=n(80015),ee=n(5338),et=n(99777);let en=(e,t)=>{let n=[],r=0;return null==t||t.forEach(t=>{let{userId:l,displayName:i,profileImage:s,positionStart:o,positionEnd:a}=t;o>r&&n.push(e.substring(r,o)),n.push('<span data-type="mention" contenteditable="false" '.concat(s?'data-avatar-url="'.concat(s,'"'):"",' data-cy="mention-').concat(i,'" ').concat(l?'data-id="'.concat(l,'"'):"",">@").concat(i,"</span>")),r=a}),r<e.length&&n.push(e.substring(r)),n.join("")},er=e=>{let{text:t,mentions:n,...i}=e,s=(0,l.useRef)(null);return(0,l.useEffect)(()=>{if(s.current){let e=en(t,n);s.current.innerHTML=e;let l=s.current.querySelectorAll('[data-type="mention"]');null==l||l.forEach(e=>{var t;let n=e.getAttribute("data-id"),l=null===(t=e.getAttribute("data-cy"))||void 0===t?void 0:t.split("mention-").pop(),i=e.getAttribute("data-avatar-url");(0,ee.createRoot)(e).render((0,r.jsx)(et.P,{element:{displayName:l||"",id:Number(n)||0,profileImageUrl:i||"",type:"mention",children:[{text:""}]}}))})}},[t,n]),(0,r.jsx)("div",{ref:s,...i})};var el=n(84074);let ei=e=>{let{when:t,wrapper:n,children:r}=e;return t?n(r):r},es=e=>{let t=e.getDate(),n=e.getMonth()+1,r=e.getFullYear(),l=e.getHours(),i=e.getMinutes(),s=e.getSeconds(),o=String(t).padStart(2,"0"),a=String(n).padStart(2,"0"),c=String(l).padStart(2,"0"),d=String(i).padStart(2,"0"),m=String(s).padStart(2,"0");return"".concat(o,"/").concat(a,"/").concat(r,", ").concat(c,":").concat(d,":").concat(m)},eo=e=>{let t=new Date(e);return"undefined"==typeof Intl||void 0===Intl.DateTimeFormat?es(t):new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1}).format(t)};var ea=n(97478);let ec=(e,t)=>{let n=Math.abs((new Date().getTime()-e.getTime())/1e3),r=ea.ED.findIndex(e=>e>n),l=Math.floor(n/(r?ea.ED[r-1]:1));return 0===l||0===r?t(ea.SY[0].shortLabel):"".concat(l).concat(t(ea.SY[r].shortLabel))};var ed=n(88718);let em=e=>{let{userName:t,userId:n,isCommunity:l=!1,commentTimestamp:s,wasEdited:o,isPinned:a,highlightedAuthorHTML:c}=e,{t:d}=(0,i.Bd)();return(0,r.jsxs)("div",{className:"mr-8 flex flex-col items-start",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(ei,{when:l,wrapper:e=>(0,r.jsx)(ed.V,{userId:n,children:e}),children:(0,r.jsx)("span",{className:"max-w-[150px] truncate text-darkblue sm:max-w-sm lg:max-w-lg",title:t,dangerouslySetInnerHTML:{__html:c?(0,el.sanitize)(c):t}})}),a&&(0,r.jsxs)("p",{className:"flex items-center gap-1 text-sm text-gray-300",children:[(0,r.jsx)(M.A,{})," ",(0,r.jsx)("span",{children:d("comments.pinned")})]})]}),(0,r.jsxs)("div",{className:"mt-2 text-[15px] leading-5 text-lightgray-100",title:eo(s),children:[ec(new Date(s),d),o&&" • (".concat(d("comments.state.edited"),")")]})]})};var eu=n(20798),ep=n(61109),ev=n(27556),eh=n(25489),ex=n(97620),ef=n(63094);let eg=e=>{var t,n,d,m;let{data:u,level:p=0,activeComment:v,setActiveComment:g,onError:C,replies:y,loadMoreReplies:j}=e,{t:b}=(0,i.Bd)(),{setComments:_,commentsList:I,repliesList:w,updateReplies:E,readOnly:k,extra:S,setPinnedComments:A,pinnedComments:L}=(0,Z.DP)(),[P,R]=(0,l.useState)((null==y?void 0:y.length)||!1),[T,F]=(0,l.useState)(!1),[D,M]=(0,l.useState)([]),B=f({commentId:u.id}),K=h({commentId:u.id}),z=x({commentId:u.id}),O=(0,l.useRef)(null),U=(0,l.useRef)(null),H=(0,l.useRef)(null),V=(0,l.useRef)(null),X=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3,{highlightedComment:r,setHighlightedComment:i}=(0,ev.Zf)(),s=(null==r?void 0:r.id)===e;return(0,l.useEffect)(()=>{if(s&&t.current){t.current.scrollIntoView({behavior:"smooth",block:"center"});let e=setTimeout(()=>{i(null)},n);return()=>clearTimeout(e)}},[s,t,i,n]),s}(u.id,V,2e3),W=u.canDeleteComment,Y=new Date(null!==(d=u.updatedAt)&&void 0!==d?d:u.createdAt).getTime(),q=u.updatedAt!==u.createdAt,$=(0,Q.E)(S),ee="object"==typeof u&&"highlight"in u,et=(0,l.useCallback)(()=>{if(H.current&&U.current){var e;let t=H.current,n=U.current,r=t.scrollHeight,l=null===(e=t.lastElementChild)||void 0===e?void 0:e.lastElementChild;if(l){let e=l.offsetHeight;n.style.height="".concat(r-e-25,"px")}}},[]),en=async()=>{P||(null==y?void 0:y.length)||null==j||j({lastCommentId:0,parentId:u.id}),R(e=>!e)},el=async()=>{var e;null===(e=V.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center"}),null==g||g(null),setTimeout(()=>null==g?void 0:g(u),10),0===p&&((null==y?void 0:y.length)||null==j||j({lastCommentId:0,parentId:u.id}),R(!0))},ei=async(e,t)=>{try{let l=await B.trigger({text:e,attachments:(0,ef.P)(t)}),i={...u,...l};if(l.isPinned?A(L.map(e=>e.id===u.id?i:e)):_(I.map(e=>e.id===u.id?i:e)),p>0&&!Array.isArray(u.parent)){var n,r;E({commentId:u.parent.id,newReplies:null===(r=w[u.parent.id])||void 0===r?void 0:null===(n=r.replies)||void 0===n?void 0:n.map(e=>e.id===u.id?i:e)})}F(!1)}catch(e){null==C||C(e)}},es=(0,l.useCallback)(()=>F(!1),[]);return(0,l.useEffect)(()=>{if(null==y?void 0:y.length)return window.addEventListener("resize",et),()=>window.removeEventListener("resize",et)},[et,null==y?void 0:y.length]),(0,l.useEffect)(()=>{et()},[P,et,y,u,T]),(0,r.jsx)(a.Q,{ref:O,attachments:u.attachments,isEditable:T,onChange:M,children:T?(0,r.jsx)(G.B,{initialValue:(0,ex.kU)(u.text,u.mentions),handleAddComment:ei,isRoot:!1,mode:eh.lX.Edit,setActiveComment:null!=g?g:()=>{},onCancel:es,editableComment:u,className:"mt-5"}):(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"relative",ref:H,id:"comment-".concat(u.id),children:[(0,r.jsxs)("div",{className:"flex w-full flex-row items-start gap-2.5 sm:gap-2.5",children:[P&&(0,r.jsx)("div",{ref:U,className:"absolute left-[20px] top-[40px] w-px bg-darkgray-100"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("img",{className:"size-10 rounded-full",title:u.userName,src:u.userAvatarUrl}),p>0&&(0,r.jsx)("div",{className:"absolute right-[39px] top-5 h-px w-[30px] bg-darkgray-100"})]}),(0,r.jsxs)("div",{className:"relative w-[calc(100%-40px)] min-w-0 grow-0 rounded-xl",children:[(0,r.jsxs)("div",{className:(0,s.Id)("relative rounded-xl bg-[#F0F3F6] p-[15px] transition-colors duration-[3000ms] ease-out",(u.id===(null==v?void 0:v.id)||X)&&"bg-blue/20"),ref:V,children:[(0,r.jsx)("div",{className:"mb-3 flex items-center justify-between",children:(0,r.jsx)(em,{userName:u.userName,userId:u.userId,isCommunity:$,commentTimestamp:Y,wasEdited:q,isPinned:null!==(m=null==u?void 0:u.isPinned)&&void 0!==m&&m,highlightedAuthorHTML:ee?null===(t=u.highlight)||void 0===t?void 0:t.author:void 0})}),(0,r.jsx)(er,{className:"mt-1 text-darkblue/70 [word-wrap:break-word] md:mt-4 [&_a:hover]:underline [&_a]:text-[#2e6ef4] [&_a]:no-underline [&_p]:m-0 [&_p]:p-0",text:ee&&(null===(n=u.highlight)||void 0===n?void 0:n.comment)||u.text,mentions:u.mentions}),(0,r.jsx)(c.A,{className:(0,s.Id)(!!(null==D?void 0:D.length)&&"pt-4")}),W&&(0,r.jsx)(J,{commentData:u,className:"absolute right-3.5 top-3 justify-self-end",onEdit:()=>F(!0)})]}),(0,r.jsxs)("div",{className:"mt-1.5 flex translate-y-1 items-center gap-2 text-sm",children:[(0,r.jsx)(N,{handleLikeClick:(e=>async()=>{try{let r=e.isLiked,l=r?-1:1,i=r?z.trigger:K.trigger;await i();let s=t=>t.id===e.id?{...t,likesCount:t.likesCount+l,isLiked:!r}:t;if(e.isPinned?A(L.map(s)):_(I.map(s)),p>0&&!Array.isArray(u.parent)){var t,n;E({commentId:u.parent.id,newReplies:null===(n=w[u.parent.id])||void 0===n?void 0:null===(t=n.replies)||void 0===t?void 0:t.map(t=>t.id===e.id?{...t,isLiked:!r,likesCount:u.likesCount+l}:t)})}}catch(e){null==C||C(e)}})(u),isLiked:u.isLiked,likesCount:u.likesCount,commentId:u.id,readOnly:!!k}),!k&&(0,r.jsx)("div",{className:"cursor-pointer font-medium text-lightgray-100 hover:text-[#5DC2FEFF]",onClick:el,children:b("comments.components.comments.reply_label")}),u.totalReplies>0&&(0,r.jsx)(o.A,{}),0===p&&!!u.totalReplies&&(0,r.jsx)("div",{className:"mr-2 flex cursor-pointer text-[#5DC2FEFF]",onClick:en,children:P?b("comments.components.comments.responses_label_hide"):"".concat(u.totalReplies," ").concat(b("comments.components.comments.responses_label",{count:u.totalReplies}))})]}),!$&&!k&&(null==v?void 0:v.id)===u.id&&(0,r.jsx)(ep.p,{parentId:Array.isArray(u.parent)?u.id:u.parent.id,setActiveComment:g,level:1,onError:C,setResponses:(e,t)=>{var n,r;let l=Array.isArray(u.parent)?u.id:u.parent.id;E({commentId:l,newReplies:[t,...null!==(r=null===(n=w[l])||void 0===n?void 0:n.replies)&&void 0!==r?r:[]]})}})]})]}),P&&(0,r.jsx)("div",{className:"ml-[50px] mt-5 flex flex-col space-y-5 md:mt-6 md:space-y-6",children:(0,r.jsx)(eu.p,{items:null!=y?y:[],renderItem:e=>(0,r.jsx)(eg,{data:e,level:1,setActiveComment:g,activeComment:v,onError:C},e.id),onLoadMore:e=>{let{lastCommentId:t}=e;return null==j?void 0:j({lastCommentId:t,parentId:u.id})},parentId:u.id,loadMoreLabel:b("comments.components.comments.load_more_label")})})]})})})}},20798:(e,t,n)=>{"use strict";n.d(t,{p:()=>u});var r=n(74848),l=n(96540),i=n(92177),s=n(50856),o=n(21576),a=n(77789),c=n(88232),d=n(8682);let m=e=>{let{children:t,className:n,lastCommentId:l,parentId:m,onClick:u,...p}=e,{commentsType:v,extra:h,currentSortOption:x}=(0,c.DP)(),f=(0,d.E)(h)?h.community.postId:h.course.pageId,g=(0,i.Ay)((0,a.b)({commentsType:v,lastCommentId:l,pageId:f,parentId:m,sortOption:x}));return(0,r.jsx)("button",{className:(0,s.QP)("mx-auto my-2 block cursor-pointer p-1.5 text-center text-base font-medium transition-colors hover:text-blue",n),disabled:g.isLoading,onClick:()=>u({lastCommentId:l,parentId:m}),...p,children:g.isLoading?(0,r.jsx)(o.a,{}):t})},u=e=>{let{items:t,renderItem:n,onLoadMore:i,parentId:s=null,loadMoreLabel:o}=e;return(0,r.jsx)(r.Fragment,{children:t.map((e,a)=>{let c=t[a+1],d=null!==e.nextId&&(!c||c.id!==e.nextId);return(0,r.jsxs)(l.Fragment,{children:[n(e),d&&(0,r.jsx)(m,{parentId:s,lastCommentId:e.id,onClick:i,children:o},"load-more-".concat(e.id))]},e.id)})})}},88232:(e,t,n)=>{"use strict";n.d(t,{ZF:()=>X,DP:()=>Q});var r=n(74848),l=n(99269),i=n(96540),s=n(69162),o=n(95759),a=n(37458),c=n(50856),d=n(67061),m=n(25489);let u=(e,t)=>{switch(e){case m.Kc.NEWEST_FIRST:return t("comments.sort.newest_first");case m.Kc.OLDEST_FIRST:return t("comments.sort.oldest_first");case m.Kc.POPULAR:return t("comments.sort.popular");default:return t("comments.sort.newest_first")}},p=e=>{let{currentSort:t,onSortChange:n,className:l,disabled:o=!1}=e,{t:p}=(0,s.Bd)(),v=(0,i.useCallback)(e=>{n(e)},[n]),h=[m.Kc.NEWEST_FIRST,m.Kc.OLDEST_FIRST,m.Kc.POPULAR];return(0,r.jsxs)("div",{className:(0,c.QP)("flex items-center gap-4",l),children:[(0,r.jsx)("p",{className:"font-semibold text-darkblue",children:p("comments.sort.label")}),(0,r.jsx)("div",{className:"relative inline-block text-left",children:(0,r.jsxs)(a.W1,{children:[(0,r.jsxs)(a.IU,{disabled:o,className:(0,c.QP)("flex items-center gap-2 rounded-lg border border-gray/10 bg-white px-4 py-2.5 text-sm font-medium text-darkblue shadow-sm transition-colors hover:bg-gray/5 focus:outline-none focus:ring-2 focus:ring-blue focus:ring-offset-2",o&&"cursor-not-allowed opacity-50"),children:[(0,r.jsx)("span",{children:u(t,p)}),(0,r.jsx)(d.A,{className:"size-4 text-bluegray"})]}),(0,r.jsx)(a.c,{className:"absolute right-0 z-20 mt-2 w-max min-w-32 max-w-52 origin-top-right rounded-lg bg-white shadow-lg ring-1 ring-black/5 focus:outline-none",children:(0,r.jsx)("div",{className:"py-1",children:h.map(e=>(0,r.jsx)(a.Dr,{children:n=>{let{active:l}=n;return(0,r.jsx)("button",{onClick:()=>v(e),className:(0,c.QP)("flex w-full items-center px-4 py-3 text-left text-sm transition-colors",l?"bg-blue/5 text-darkblue":"text-gray-700",t===e&&"bg-blue/10 font-semibold text-blue"),children:u(e,p)})}},e))})})]})})]})};var v=n(20798),h=n(61109);function x(e){let[t,n]=(0,i.useState)(null),r=(0,i.useRef)(null);return{ref:(0,i.useCallback)(t=>{if(r.current&&(r.current.disconnect(),r.current=null),null===t){n(null);return}r.current=new IntersectionObserver(e=>{let[t]=e;n(t)},e),r.current.observe(t)},[null==e?void 0:e.rootMargin,null==e?void 0:e.root,null==e?void 0:e.threshold]),entry:t}}var f=n(53285),g=n(80015),C=n(19660);let y=e=>{let{parentId:t,setActiveComment:n=()=>{},setResponses:l=()=>{},setOpenedResponses:i=()=>{},onError:s,level:o=0,replyInfo:a}=e,{ref:d,entry:m}=x({threshold:1}),{handleAddComment:u,attachmentsRef:p,attachments:v,setAttachments:h,initialValue:y}=(0,C.a)({parentId:t,level:o,setActiveComment:n,setResponses:l,setOpenedResponses:i,onError:s,replyInfo:a}),j=!(null==m?void 0:m.isIntersecting);return(0,r.jsxs)(f.Q,{ref:p,isEditable:!0,onChange:h,children:[(0,r.jsx)("div",{ref:d,className:"invisible absolute bottom-0 left-0 size-1"}),(0,r.jsx)(g.B,{className:(0,c.QP)("sticky bottom-0 left-0 z-10 -mx-8 mt-4 w-[calc(100%+32px)] rounded-b-lg bg-white p-2 sm:-mx-6 sm:w-[calc(100%+48px)] sm:px-6 md:-mx-8 md:w-[calc(100%+64px)]",j&&"shadow-[0_-2px_2px_-1px_rgba(0,0,0,0.1)]"),handleAddComment:u,setActiveComment:n,isRoot:!0,initialValue:y})]})},j=e=>{let{parentId:t,setActiveComment:n=()=>{},setResponses:l=()=>{},setOpenedResponses:i=()=>{},onError:s,level:o=0,replyInfo:a}=e,{ref:d,entry:m}=x({threshold:1}),{handleAddComment:u,attachmentsRef:p,setAttachments:v,initialValue:h}=(0,C.a)({parentId:t,level:o,setActiveComment:n,setResponses:l,setOpenedResponses:i,onError:s,replyInfo:a}),y=!(null==m?void 0:m.isIntersecting);return(0,r.jsxs)(f.Q,{ref:p,isEditable:!0,onChange:v,children:[(0,r.jsx)("div",{ref:d,className:"invisible absolute bottom-0 left-0 size-1"}),(0,r.jsx)(g.B,{className:(0,c.QP)("sticky bottom-0 left-0 z-10 -mx-8 mt-4 w-[calc(100%+32px)] rounded-b-lg bg-white p-2 sm:-mx-6 sm:w-[calc(100%+48px)] sm:px-6 md:-mx-8 md:w-[calc(100%+64px)]",y&&"shadow-[0_-2px_2px_-1px_rgba(0,0,0,0.1)]"),onCancel:()=>n(null),handleAddComment:u,setActiveComment:n,isRoot:!1,initialValue:h})]})};var b=n(27556),_=n(32650),I=n(77789);let w=e=>{let t=new URLSearchParams(e.split("?")[1]||"").get("parent");return{parentId:parseInt(t||"0",10),isReply:"null"!==t}},E=(e,t)=>{for(let r of e){var n;if(r.id===t)return r;if(null===(n=r.children)||void 0===n?void 0:n.length){let e=r.children.find(e=>e.id===t);if(e)return e}}return null},k=(e,t,n,r,l)=>{if(t&&e.length>0&&!r){let r=E(e,t);if(r){n(r);return}null==l||l(void 0)}};var N=n(18987);let S="comment_sort_preference",A=e=>{try{let e=N.A.get(S);if(e&&Object.values(m.Kc).includes(e))return e}catch(t){e("Failed to get comment sort preference",t)}return null},L=(e,t)=>{try{N.A.set(S,e,{expires:365,secure:!0,sameSite:"lax"})}catch(e){t("Failed to save comment sort preference",e)}};var P=n(9877);let R=(e,t)=>{let n=[...e];return t.forEach(e=>{let t=n.findIndex(t=>t.id===e.id);-1!==t?n[t]=e:n.push(e)}),n},T=e=>{let{commentsType:t,pageId:n,shouldFetch:r=!0,onError:s,targetCommentId:o,isCommunityComments:a,setHighlightedComment:c,highlightedComment:d}=e,m=(0,l.S)(),{mutate:u}=(0,_.iX)(),[p,v]=(0,i.useState)(()=>A(m.warning)||(0,P.ZA)(a)),[h,x]=(0,i.useState)(o),[f,g]=(0,i.useState)([]),[C,y]=(0,i.useState)({}),[j,b]=(0,i.useState)({lastCommentId:0,parentId:null}),E=(0,i.useCallback)(e=>{let{commentId:t,newReplies:n}=e;y(e=>{let r=e[t]||{replies:[]};return{...e,[t]:{replies:null!=n?n:r.replies}}})},[]),N=(0,I.u)({parentId:j.parentId,commentsType:t,pageId:n,lastCommentId:j.lastCommentId,targetCommentId:0===j.lastCommentId&&!j.parentId&&h?h:void 0,sortOption:p,config:{revalidateOnMount:r,revalidateOnFocus:!1,revalidateOnReconnect:!1,onSuccess:(e,t)=>{let{isReply:n,parentId:r}=w(t);if(n){var l,i;E({commentId:r,newReplies:R([...null!==(i=null===(l=C[r])||void 0===l?void 0:l.replies)&&void 0!==i?i:[]],null!=e?e:[])})}else g(t=>0===j.lastCommentId?null!=e?e:[]:R(t,null!=e?e:[])),null==e||e.forEach(e=>{if(e.children){var t,n;E({commentId:e.id,newReplies:R([...null!==(n=null===(t=C[e.id])||void 0===t?void 0:t.replies)&&void 0!==n?n:[]],e.children)})}});k(e,h,c,d,x)},onError:(e,t)=>{let{isReply:n,parentId:r}=w(t);n&&E({commentId:r,newReplies:[]}),s&&s(e)}}}),S=(0,i.useCallback)(e=>{let r=(0,I.b)({parentId:j.parentId,commentsType:t,pageId:n,lastCommentId:j.lastCommentId,sortOption:p,targetCommentId:0===j.lastCommentId&&!j.parentId&&h?h:void 0}),l={lastCommentId:0,parentId:null};b(l),g([]),y({});let i=(0,I.b)({parentId:l.parentId,commentsType:t,pageId:n,lastCommentId:l.lastCommentId,sortOption:e,targetCommentId:0===l.lastCommentId&&!l.parentId&&h?h:void 0});u(r,void 0,{revalidate:!1}),u(i,void 0,{revalidate:!0})},[j.parentId,j.lastCommentId,t,n,p,h,u]),L=(0,i.useCallback)(e=>{e!==p&&(v(e),S(e))},[p,S]),T=(0,i.useCallback)(e=>{let{lastCommentId:t,parentId:n}=e;n?(E({commentId:n}),b({lastCommentId:t,parentId:n})):b({lastCommentId:t,parentId:null})},[E]);return{comments:f,replies:C,sortOption:p,requestParams:j,updateReplies:E,handleSortChange:L,handleLoadMoreGap:T,getPageCommentsQuery:N,setComments:g}};var F=n(60720),D=n(92177),M=n(63927),B=n(75526),K=n(68635),z=n(99116);let O=e=>{var t;let{lastCommentId:n,parentId:r,postId:l,sortOrder:i=F.e.ASC,targetCommentId:s}=e,o=new URLSearchParams;return o.set("pagination[order]",i),o.set(z.i.community,l.toString()),o.set("parent",null!==(t=null==r?void 0:r.toString())&&void 0!==t?t:"null"),s&&o.set("commentId",s.toString()),0!==n&&o.set("pagination[startFrom]",n.toString()),"".concat(M.cm,"/pinned?").concat(o.toString())},U=e=>{let{lastCommentId:t,parentId:n,postId:r,sortOrder:l,targetCommentId:i,config:s}=e,{fetcher:o}=(0,B.e)({method:K.Z.get});return(0,D.Ay)(O({lastCommentId:t,parentId:n,postId:r,sortOrder:l,targetCommentId:i}),o,s)},Z=e=>{let{postId:t,setActiveComment:n,activeComment:s,onError:a,targetCommentId:c}=e,d=(0,l.S)(),{pinnedComments:m,setPinnedComments:u,updateReplies:p,repliesList:v}=Q(),{setHighlightedComment:h,highlightedComment:x}=(0,b.Zf)(),[f,g]=(0,i.useState)(c),[C,y]=(0,i.useState)({lastCommentId:0,parentId:null});U({parentId:C.parentId,lastCommentId:C.lastCommentId,targetCommentId:0===C.lastCommentId&&!C.parentId&&f?f:void 0,postId:t,sortOrder:F.e.ASC,config:{revalidateOnMount:!0,revalidateOnFocus:!1,revalidateOnReconnect:!1,onSuccess:e=>{u(t=>R(t,null!=e?e:[])),e.forEach(e=>{if(e.children){var t,n;p({commentId:e.id,newReplies:R([...null!==(n=null===(t=v[e.id])||void 0===t?void 0:t.replies)&&void 0!==n?n:[]],e.children)})}}),k(e,f,h,x,g)},onError:(e,t)=>{let{isReply:n,parentId:r}=w(t);n&&p({commentId:r,newReplies:[]}),d.error("fetch pinned comments error",e)}}});let j=(0,i.useCallback)(e=>{let{lastCommentId:t,parentId:n}=e;n?(p({commentId:n}),y({lastCommentId:t,parentId:n})):y({lastCommentId:t,parentId:null})},[p]);return(0,r.jsx)(r.Fragment,{children:m.map(e=>{var t;return(0,r.jsx)(o.M,{data:e,level:0,setActiveComment:n,activeComment:s,onError:a,replies:null===(t=v[e.id])||void 0===t?void 0:t.replies,loadMoreReplies:j},e.id)})})},H=(0,i.createContext)({}),Q=()=>(0,i.useContext)(H),V=e=>{let{commentsType:t,shouldFetch:n=!0,readOnly:a=!1,onError:c,targetCommentId:d,commentsHighlightContext:m}=e,u=(0,l.S)(),{t:x}=(0,s.Bd)(),{setHighlightedComment:f,highlightedComment:g}=(0,b.Zf)(),C="community"in e,_=C?e.community.postId:e.course.pageId,[I,w]=(0,i.useState)(null),[E,k]=(0,i.useState)([]),{comments:N,replies:S,sortOption:A,updateReplies:P,handleSortChange:R,handleLoadMoreGap:F,getPageCommentsQuery:D,setComments:M}=T({commentsType:t,pageId:_,shouldFetch:n,onError:e=>{c&&c(e),u.error("Comments error",e)},targetCommentId:d,isCommunityComments:C,setHighlightedComment:f,highlightedComment:g}),B=!(null!==I)&&!a;(0,i.useEffect)(()=>{if(!I)return;let e=e=>{"Escape"===e.key&&(e.stopPropagation(),w(null))};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[I]),(0,i.useEffect)(()=>{if((null==m?void 0:m.targetCommentId)&&(null==N?void 0:N.length)){let e=document.getElementById("comment-".concat(null==m?void 0:m.targetCommentId)),t=document.querySelector('[data-scrollable="comments-container"]');e&&(null==t||t.scrollTo({top:e.offsetTop,behavior:"smooth"}))}},[null==m?void 0:m.targetCommentId,!!(null==N?void 0:N.length)]);let K=I&&C?{userId:I.userId,displayName:I.userName,profileImage:I.userAvatarUrl}:void 0,z=C?{community:{communityPath:e.community.communityPath,postId:e.community.postId}}:{course:{pageId:e.course.pageId}},O=(Array.isArray(null==I?void 0:I.parent)?null==I?void 0:I.id:null==I?void 0:I.parent.id)||null;return(0,r.jsx)(H.Provider,{value:{commentsType:t,commentsList:N,setComments:M,repliesList:S,updateReplies:P,pinnedComments:E,setPinnedComments:k,readOnly:a,extra:z,currentSortOption:A},children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("div",{className:"flex flex-col items-stretch space-y-5 md:space-y-6",children:[(N.length>0||E.length>0)&&(0,r.jsx)(p,{currentSort:A,onSortChange:e=>{L(e,u.warning),R(e)},disabled:D.isLoading}),!C&&B&&(0,r.jsx)(h.p,{parentId:null,onError:c}),C&&(0,r.jsx)(Z,{postId:e.community.postId,setActiveComment:w,activeComment:I,onError:c,targetCommentId:d}),(0,r.jsx)(v.p,{items:N,renderItem:e=>{var t,n;let l=null==m?void 0:null===(t=m.searchHighlightedComments)||void 0===t?void 0:t.find(t=>t.id===e.id);return(0,r.jsx)(o.M,{data:{...null!=l?l:{},...e},level:0,setActiveComment:w,activeComment:I,onError:c,replies:null===(n=S[e.id])||void 0===n?void 0:n.replies,loadMoreReplies:F},e.id)},onLoadMore:F,parentId:null,loadMoreLabel:x("comments.components.comments.load_more_label")})]}),C?B?(0,r.jsx)(y,{parentId:null,onError:c}):(0,r.jsx)(j,{parentId:O,setActiveComment:w,onError:c,replyInfo:K,setResponses:(e,t)=>{var n,r,l,i;return P({commentId:e,newReplies:C?[...null!==(l=null===(n=S[e])||void 0===n?void 0:n.replies)&&void 0!==l?l:[],t]:[t,...null!==(i=null===(r=S[e])||void 0===r?void 0:r.replies)&&void 0!==i?i:[]]})}}):null]})})},X=e=>(0,r.jsx)(b.pf,{children:(0,r.jsx)(V,{...e})})},69552:(e,t,n)=>{"use strict";n.d(t,{ZF:()=>r.ZF}),n(95759),n(80015);var r=n(88232)},61109:(e,t,n)=>{"use strict";n.d(t,{p:()=>o});var r=n(74848),l=n(53285),i=n(80015),s=n(19660);let o=e=>{let{parentId:t,setActiveComment:n=()=>{},setResponses:o=()=>{},setOpenedResponses:a=()=>{},onError:c,level:d=0,replyInfo:m}=e,{handleAddComment:u,attachmentsRef:p,attachments:v,setAttachments:h,initialValue:x}=(0,s.a)({parentId:t,level:d,setActiveComment:n,setResponses:o,setOpenedResponses:a,onError:c,replyInfo:m});return(0,r.jsx)(l.Q,{ref:p,isEditable:!0,onChange:h,children:(0,r.jsx)(i.B,{handleAddComment:u,setActiveComment:n,isRoot:0===d,initialValue:x})})}},19660:(e,t,n)=>{"use strict";n.d(t,{a:()=>C});var r=n(96540),l=n(71069),i=n(53616),s=n(63927),o=n(95336),a=n(75526),c=n(68635);let d=e=>{let{config:t}=e,{fetcher:n}=(0,a.e)({method:c.Z.post});return(0,i.A)(s.cm,(0,o.u)(n),t)};var m=n(88232),u=n(27556),p=n(9877),v=n(47598),h=n(8682),x=n(5150),f=n(63094);let g=(e,t)=>e.map(e=>e.id===t?{...e,totalReplies:e.totalReplies+1}:e);function C(e){let{parentId:t,level:n=0,setActiveComment:i=()=>{},setOpenedResponses:s=()=>{},onError:o,replyInfo:a}=e,{setComments:c,commentsList:C,extra:y,repliesList:j,updateReplies:b,currentSortOption:_}=(0,m.DP)(),{setHighlightedComment:I}=(0,u.Zf)(),w=t?"/api/comment/comments/".concat(t):null,E=(0,r.useRef)(null),[k,N]=(0,r.useState)([]),S=d({}),A=(0,h.E)(y);return{handleAddComment:async function(e){try{var r;let o={text:e,parent:w,...A?{commentSourceCommunityPost:{communityPostId:y.community.postId}}:{commentSourcePage:{pageId:y.course.pageId}},attachments:(0,f.P)(k)},a={...await S.trigger(o),__isNew:!0,nextId:null};if(null===t)c(e=>(0,v.Tv)(e,a,(0,p.j2)(_)?null:(0,v.ls)(e)));else{let e=g(C,t);c(e),0===n&&s(!0),b({commentId:t,newReplies:(0,v.Tv)(j[t].replies,a,(0,v.ls)(j[t].replies))})}A&&I(a),i(null),A&&(0,l.j)((0,x.X)(y.community.communityPath,[y.community.postId])),null===(r=E.current)||void 0===r||r.clear()}catch(e){o&&o(e)}},attachmentsRef:E,attachments:k,setAttachments:N,initialValue:a?[{type:"paragraph",children:[{type:"mention",displayName:a.displayName,id:a.userId,profileImageUrl:a.profileImage,children:[{text:""}]},{text:", "}]}]:void 0}}},27556:(e,t,n)=>{"use strict";n.d(t,{Zf:()=>s,pf:()=>o});var r=n(74848),l=n(96540);let i=(0,l.createContext)(void 0),s=()=>{let e=(0,l.useContext)(i);if(!e)throw Error("useCommentHighlight must be used within a CommentHighlightProvider");return e},o=e=>{let{children:t}=e,[n,s]=(0,l.useState)(null),o=(0,l.useMemo)(()=>({highlightedComment:n,setHighlightedComment:s}),[n,s]);return(0,r.jsx)(i.Provider,{value:o,children:t})}},25489:(e,t,n)=>{"use strict";n.d(t,{Kc:()=>l,Kf:()=>r,lX:()=>i});var r=function(e){return e.Community="community",e.Page="page",e}({});let l={NEWEST_FIRST:"newest_first",OLDEST_FIRST:"oldest_first",POPULAR:"popular"};var i=function(e){return e.Add="ADD",e.Edit="EDIT",e}({})},9877:(e,t,n)=>{"use strict";n.d(t,{Fx:()=>d,Tc:()=>c,U4:()=>o,ZA:()=>i,j2:()=>m});var r=n(60720),l=n(25489);let i=e=>e?l.Kc.OLDEST_FIRST:l.Kc.NEWEST_FIRST,s=e=>e.likesCount+e.totalReplies,o=e=>{let t=u(e)?r.e.ASC:r.e.DESC;return{sortBy:p(e)?"popularity":"id",sortOrder:p(e)?r.e.DESC:t}},a=e=>(t,n)=>{switch(e){case l.Kc.POPULAR:{let e=s(t),r=s(n);if(e!==r)return r-e;return n.id-t.id}case l.Kc.NEWEST_FIRST:return n.id-t.id;case l.Kc.OLDEST_FIRST:return t.id-n.id;default:return n.id-t.id}},c=(e,t)=>[...e].sort(a(t)),d=(e,t,n)=>{switch(n){case l.Kc.POPULAR:{let n=s(e),r=s(t);if(n!==r)return n>r;return e.id>t.id}case l.Kc.NEWEST_FIRST:return e.id>t.id;case l.Kc.OLDEST_FIRST:return e.id<t.id;default:return e.id>t.id}},m=e=>e===l.Kc.NEWEST_FIRST,u=e=>e===l.Kc.OLDEST_FIRST,p=e=>e===l.Kc.POPULAR},47598:(e,t,n)=>{"use strict";n.d(t,{Hp:()=>l,Tv:()=>s,i$:()=>i,ls:()=>o});var r=n(9877);let l=(e,t)=>{let n=new Map(e.map(e=>[e.id,{...e}])),r=n.get(t);if(!r)return e;let{prevId:l,nextId:i}=r;if(null!=l){let e=n.get(l);e&&(e.nextId=null!=i?i:null)}if(null!=i){let e=n.get(i);e&&(e.prevId=null!=l?l:null)}return n.delete(t),[...n.values()]},i=(e,t,n)=>{var l;if(0===e.length)return null;let i=e.findIndex(e=>e.id===t.id);if(-1!==i)return e[i].prevId;let s=(0,r.Tc)(e,n),o=null;for(let e of s){if((0,r.Fx)(t,e,n))break;o=e}return null!==(l=null==o?void 0:o.id)&&void 0!==l?l:null},s=(e,t,n)=>{let r=e.map(e=>({...e})),l=null===n?0:(()=>{let e=r.findIndex(e=>e.id===n);if(-1===e)throw Error("prevId ".concat(n," not found"));return e+1})(),i=l>0?r[l-1]:null,s=l<r.length?r[l]:null,o={...t,prevId:i?i.id:null,nextId:s?s.id:null};return i&&(i.nextId=o.id),s&&(s.prevId=o.id),r.splice(l,0,o),r},o=e=>e.length>0?e[e.length-1].id:null},99116:(e,t,n)=>{"use strict";n.d(t,{i:()=>l,m:()=>i});var r=n(25489);let l={[r.Kf.Page]:"commentSourcePage.pageId",[r.Kf.Community]:"commentSourceCommunityPost.communityPostId"},i=[{id:1,format:"link",type:"link"},{id:2,format:"mention",type:"mention"}]},8682:(e,t,n)=>{"use strict";n.d(t,{E:()=>r});let r=e=>"object"==typeof e&&"community"in e},5150:(e,t,n)=>{"use strict";n.d(t,{D:()=>a,X:()=>o});var r=n(92177),l=n(63927),i=n(75526),s=n(68635);let o=(e,t)=>{let n=new URLSearchParams;return t.forEach(e=>n.append("ids[]",String(e))),"".concat(l.mv,"/").concat(e,"/posts/comments-count?").concat(n.toString())},a=e=>{let{communityPath:t,postsIds:n,config:l}=e,{fetcher:a}=(0,i.e)({method:s.Z.get});return(0,r.Ay)(()=>t&&n?o(t,n):null,a,l)}},60720:(e,t,n)=>{"use strict";n.d(t,{e:()=>r});let r={DESC:"desc",ASC:"asc"}},86899:(e,t,n)=>{"use strict";n.d(t,{U:()=>s});var r=n(96540);let l=(e,t)=>{try{return e.addEventListener("change",t),()=>e.removeEventListener("change",t)}catch(n){return e.addListener(t),()=>e.removeListener(t)}},i=(e,t)=>"boolean"==typeof t?t:"matchMedia"in window&&window.matchMedia(e).matches,s=function(e,t){let{getInitialValueInEffect:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{getInitialValueInEffect:!0},[s,o]=(0,r.useState)(n?t:i(e)),a=(0,r.useRef)(void 0);return(0,r.useEffect)(()=>{if("matchMedia"in window)return a.current=window.matchMedia(e),o(a.current.matches),l(a.current,e=>o(e.matches))},[e]),s}},15117:(e,t,n)=>{"use strict";function r(e,t){let n;return function(){for(var r=arguments.length,l=Array(r),i=0;i<r;i++)l[i]=arguments[i];clearTimeout(n),n=setTimeout(()=>{e(...l)},t)}}n.d(t,{s:()=>r})},94156:e=>{e.exports={LikeContainer:"Likes_LikeContainer__oaaQI",LikeIcon:"Likes_LikeIcon__J9tEG",LikeButton:"Likes_LikeButton__h0YCg",active:"Likes_active__8J4Jk",LikeCount:"Likes_LikeCount__BOriF",Popover:"Likes_Popover__nAnTT",PopoverBody:"Likes_PopoverBody__K2I31",PopoverContent:"Likes_PopoverContent__WL7iq",LoaderContainer:"Likes_LoaderContainer__haYvh",PopoverLikeName:"Likes_PopoverLikeName__u1JSS",PopoverOverflowLikes:"Likes_PopoverOverflowLikes__Wmmux"}},15253:e=>{e.exports={CommentAddCommentButton:"CommentEditor_CommentAddCommentButton__V53m_",CommentAddCommentButtonDisabled:"CommentEditor_CommentAddCommentButtonDisabled__xXq1C",CommentAddCommentButtonActive:"CommentEditor_CommentAddCommentButtonActive__MQ9E7",CommentEditorContainer:"CommentEditor_CommentEditorContainer___ONz3",CommentEmojiContainer:"CommentEditor_CommentEmojiContainer__krfsf",CommentEmojiContent:"CommentEditor_CommentEmojiContent__smdFW",CommentMention:"CommentEditor_CommentMention__4S4Uc",CommentMentionPopover:"CommentEditor_CommentMentionPopover__4jQKl",CommentMentionPopoverUserAvatar:"CommentEditor_CommentMentionPopoverUserAvatar__mkPX1",CommentMentionPopoverDisplayName:"CommentEditor_CommentMentionPopoverDisplayName__g8K0v"}},35640:e=>{e.exports={Popper:"SuggestionMention_Popper__V4Ygx",Suggestion:"SuggestionMention_Suggestion__hev_J",Avatar:"SuggestionMention_Avatar__35Ym_",DisplayName:"SuggestionMention_DisplayName__EbyFA",LoaderContainer:"SuggestionMention_LoaderContainer__VYBO5"}},70530:e=>{e.exports={SelectDropdown:"ListBox_SelectDropdown___qNoC"}}}]);
//# sourceMappingURL=76880-ee2ffe5ca553ae43.js.map