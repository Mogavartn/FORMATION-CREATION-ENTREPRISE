"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[90102],{88770:(e,t,r)=>{r.d(t,{H:()=>v});var n=r(74848);r(96540);var l=r(69162),u=r(50856),i=r(15403),a=r(29462),s=r(79522),o=r(27901),c=r(26469),d=r(83710);let v=e=>{let{blockingStep:t}=e,{t:r}=(0,l.Bd)(),v=(0,a.L)(),{findStepById:f,findStep:m,step:b}=(0,s.A)(),p=f(t);(null==p?void 0:p.available)||(p=m());let[y,h]=(null==b?void 0:b.type)===o.b.quiz?["course.quiz.complete_all_lectures_message","course.quiz.go_to_uncompleted_lecture_button"]:["course.quiz.complete_previous_module_message","course.quiz.go_to_uncompleted_module_button"];return(0,n.jsx)(d.o,{className:(0,c.B)("course__info-screen--need-to-complete-module"),text:r(y),buttons:(0,n.jsx)(i.r,{className:(0,u.Id)("font-bold",(0,c.B)("course__button--go-to-uncompleted-module")),href:"/school/course/".concat(v,"/").concat(null==p?void 0:p.type,"/").concat(null==p?void 0:p.id),isNext:!0,children:r(h)})})}},12979:(e,t,r)=>{r.d(t,{O:()=>s});var n=r(74848);r(96540);var l=r(69162),u=r(79522),i=r(26469),a=r(73231);let s=()=>{let{t:e}=(0,l.Bd)(),{onNextStep:t,isEnd:r}=(0,u.A)();return(0,n.jsx)(a.z,{className:"font-bold ".concat((0,i.B)(r?"course__button--mark-lecture-as-completed":"course__button--next-lecture")),onClick:t,disabled:r,children:e(r?"course.course_completed":"course.next_step_button_label")})}},6187:(e,t,r)=>{r.d(t,{A:()=>z});var n=r(74848),l=r(96540),u=[{hidden:"hidden",event:"visibilitychange",state:"visibilityState"},{hidden:"webkitHidden",event:"webkitvisibilitychange",state:"webkitVisibilityState"},{hidden:"mozHidden",event:"mozvisibilitychange",state:"mozVisibilityState"},{hidden:"msHidden",event:"msvisibilitychange",state:"msVisibilityState"},{hidden:"oHidden",event:"ovisibilitychange",state:"oVisibilityState"}],i="undefined"!=typeof document&&!!document.addEventListener,a=function(){if(!i)return null;var e=!0,t=!1,r=void 0;try{for(var n,l=u[Symbol.iterator]();!(e=(n=l.next()).done);e=!0){var a=n.value;if(a.hidden in document)return a}}catch(e){t=!0,r=e}finally{try{!e&&l.return&&l.return()}finally{if(t)throw r}}return null}(),s=function(){if(!a)return[!0,"visible"];var e=a.hidden,t=a.state;return[!document[e],document[t]]},o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,l=!1,u=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){l=!0,u=e}finally{try{!n&&a.return&&a.return()}finally{if(l)throw u}}return r}(e,t);throw TypeError("Invalid attempt to destructure non-iterable instance")},c=i&&a;let d=function(){var e=o(s(),1)[0],t=o((0,l.useState)(e),2),r=t[0],n=t[1];return(0,l.useEffect)(function(){if(c){var e=function(){n(o(s(),1)[0])};return document.addEventListener(a.event,e),function(){document.removeEventListener(a.event,e)}}},[]),r},v=e=>{let[t,r]=(0,l.useState)(0),n=(0,l.useRef)(!1),u=(0,l.useRef)();(0,l.useEffect)(()=>{if(0!==t||e.runImmediately)return u.current=setTimeout(()=>{e.onDelayOver(),n.current=!1},1e3*e.delay),n.current=!0,()=>{clearTimeout(u.current),n.current=!1}},[e.delay,e.onDelayOver,t,e.runImmediately]);let i=(0,l.useCallback)(()=>{clearTimeout(u.current),n.current=!1},[]),a=(0,l.useCallback)(()=>r(e=>e+1),[]);return{clear:i,restart:a,start:a,isRunning:(0,l.useCallback)(()=>n.current,[]),hasRun:t>=1}},f=e=>{let t=(0,l.useRef)(e.limitSeconds),r=(0,l.useRef)(),[n,u]=(0,l.useState)(!1),i=(0,l.useCallback)(()=>{t.current=e.limitSeconds,u(!1)},[e.limitSeconds]),a=(0,l.useCallback)(()=>u(!0),[]),s=(0,l.useCallback)(()=>t.current,[]),o=(0,l.useCallback)(()=>{t.current=e.limitSeconds,u(!0)},[e.limitSeconds]),c=(0,l.useCallback)(e=>{clearInterval(e),r.current=void 0,u(!1)},[]);return(0,l.useEffect)(()=>{if(!n){r.current&&clearInterval(r.current);return}return r.current=setInterval(()=>{if(t.current>0){t.current-=1;return}r.current&&c(r.current),e.onTimeOver()},1e3),()=>r.current&&c(r.current)},[e.onTimeOver,n]),(0,l.useEffect)(()=>{t.current=e.limitSeconds},[e.limitSeconds]),{timeLeft:s,start:a,reset:i,restart:o}};var m=r(27542),b=r(32650),p=r(75526),y=r(68635),h=function(e){return e.InitLecture="/api/membership/lecture",e.UpdateLecture="/api/membership/lecture/session",e.InitQuiz="/api/membership/quiz",e.UpdateQuiz="/api/membership/quiz/session",e}({}),g=r(27901),S=r(16857);let _=()=>{let{mutate:e}=(0,b.iX)(),t=(0,S.r)(),r=(0,l.useCallback)(()=>e(t,e=>e?{...e,lectureSessionLogging:!1}:e,{revalidate:!0}),[t,e]),{fetcher:n}=(0,p.e)({method:y.Z.post,accessDeniedResponseHandler:()=>null,lockedResponseHandler:r}),{fetcher:u}=(0,p.e)({method:y.Z.post,lockedResponseHandler:r});return{startTrackingSession:(0,l.useCallback)((e,t)=>{switch(t){case g.b.lecture:return n("".concat(h.InitLecture,"/").concat(e,"/session/create"));case g.b.quiz:return n("".concat(h.InitQuiz,"/").concat(e,"/session/create"))}},[]),updateTrackingSession:(0,l.useCallback)((e,t)=>{switch(t){case g.b.lecture:return u("".concat(h.UpdateLecture,"/").concat(e));case g.b.quiz:return u("".concat(h.UpdateQuiz,"/").concat(e))}},[])}},k=()=>{let e=(0,l.useRef)(),t=(0,l.useRef)(),r=(0,l.useRef)(),{step:n}=(0,m.o)(),{startTrackingSession:u,updateTrackingSession:i}=_(),a=d(),s=f({limitSeconds:30,onTimeOver:(0,l.useCallback)(async()=>{e.current&&r.current&&(await i(e.current,r.current),s.restart())},[])}),o=v({delay:5,onDelayOver:(0,l.useCallback)(async()=>{if(t.current&&r.current){let n=await u(t.current,r.current);if(!(null==n?void 0:n.sessionId))return void o.restart();e.current=n.sessionId,s.start()}},[u])}),c=v({delay:30,onDelayOver:(0,l.useCallback)(async()=>{s.reset(),e.current=void 0},[s.reset])});(0,l.useEffect)(()=>{(null==n?void 0:n.id)&&(null==n?void 0:n.type)&&(t.current=n.id,r.current=n.type,e.current=void 0,s.reset(),o.restart())},[null==n?void 0:n.id,null==n?void 0:n.type]),(0,l.useEffect)(()=>{if(!o.isRunning()){o.start();return}if(!a){c.start();return}if(c.isRunning()){c.clear();return}c.hasRun&&(o.restart(),e.current=void 0)},[a,c.start,c.isRunning,c.clear,c.hasRun,o.start])};function z(){return k(),(0,n.jsx)(n.Fragment,{})}},27542:(e,t,r)=>{r.d(t,{g:()=>f,o:()=>m});var n=r(96540),l=r(86715),u=r(60146),i=r(16857),a=r(56753),s=r(29462),o=r(47575),c=r(27901),d=r(43932),v=r(34280);let f=e=>{let t=/\/\[coursePath\]\/(.*)\//gm.exec(e);return null==t?void 0:t[1]},m=()=>{let e=(0,l.useRouter)(),t=(0,s.L)(),r=(0,n.useRef)(null),m=(0,n.useRef)(!1),[b,p]=(0,n.useState)([]),[y,h]=(0,n.useState)(null),[g,S]=(0,n.useState)(null),[_,k]=(0,n.useState)(!0),[z,I]=(0,n.useState)(!0),[C,R]=(0,n.useState)(!0),{courseData:w}=(0,i.B)(),x=null==w?void 0:w.id,{courseMenu:E}=(0,a.o)({courseId:x}),{isLG:L}=(0,u.A)(),q=(0,o.g)(),T=null!==g?b[g]:void 0,O=null!==y,N=(0,n.useCallback)(e=>{e||h(null)},[]),P=(0,n.useCallback)(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];y!==g&&h(g),S(...t)},[g]),{lectureId:A,quizId:B,preview:H}=e.query,j=(0,v.L)(A),D=(0,v.L)(B),Q=f(e.route),U="true"===H;(0,n.useLayoutEffect)(()=>{T&&null!==g&&(b.slice(0,g).some(e=>e.available)?R(!1):R(!0),b.slice(g+1).some(e=>e.available)?I(!1):I(!0))},[b,T,g]),(0,n.useLayoutEffect)(()=>{if(E){let e=[];for(let t of E){for(let r of t.lectures)e.push({module:{name:t.name,available:t.available,salesPage:t.salesPage},type:c.b.lecture,...r});t.quiz&&e.push({module:{name:t.name,available:t.available,salesPage:t.salesPage},type:c.b.quiz,...t.quiz})}p(e)}},[E]);let V=(0,n.useCallback)(()=>{let r=Q&&(j||D)&&b.findIndex(e=>{let{id:t,type:r}=e;return r===Q&&[j,D].some(e=>e===t)});if(g!==r){if("number"==typeof r&&!Number.isNaN(r)&&-1!==r&&(b[r].available||b[r].module.salesPage))P(r);else if(U||_)P(null);else{let r=b.filter(e=>{let{available:t}=e;return t}),n=r.filter(e=>{let{completed:t}=e;return!t}),l=null;if(n.length?l=b.findIndex(e=>{let{id:t}=e;return t===n[0].id}):r.length?l=b.findIndex(e=>{let{id:t}=e;return t===r[0].id}):b.length&&(l=0),l===g)return;P(-1===l?null:l),t&&l&&b[l]&&e.push((0,d.v)({coursePath:t,type:b[l].type,id:b[l].id}),void 0,{shallow:!0})}}},[Q,j,D,b,U,_,t,e,P,g]);return(0,n.useLayoutEffect)(()=>{b.length&&!O&&V()},[V,O,b.length]),(0,n.useEffect)(()=>{(null==T?void 0:T.id)&&new Promise(e=>e()).then(()=>{if(m.current)m.current=!1;else{var e;L?window.scrollTo({top:0,behavior:"smooth"}):(null===(e=r.current)||void 0===e?void 0:e.offsetTop)&&window.scrollTo({top:r.current.offsetTop-170,behavior:"smooth"})}})},[null==T?void 0:T.id]),(0,n.useEffect)(()=>{t&&e.isReady&&(null==T?void 0:T.id)&&([j,D].every(e=>e!==T.id)||Q!==(null==T?void 0:T.type))&&e.push((0,d.v)({coursePath:t,id:T.id,type:T.type}),void 0,{shallow:!0})},[x,t,null==T?void 0:T.id,null==T?void 0:T.type,e.isReady,Q]),(0,n.useLayoutEffect)(()=>{!w||q&&Q&&(j||D)||k(!1)},[w,q,Q,j,D]),{contentRef:r,step:T,steps:b,setStepIndex:P,onOpenLecture:e=>P(b.findIndex(t=>t.type===c.b.lecture&&t.id===e)),onOpenQuiz:e=>P(b.findIndex(t=>t.type===c.b.quiz&&t.id===e)),onPreviousStep:()=>{null===g||C||P(b.findIndex(e=>{var t;let{id:r}=e;return r===(null===(t=b.slice(0,g).reverse().find(e=>e.available))||void 0===t?void 0:t.id)}))},onNextStep:()=>{null===g||z||P(b.findIndex(e=>{var t;let{id:r}=e;return r===(null===(t=b.slice(g+1).find(e=>e.available))||void 0===t?void 0:t.id)}))},isInitialized:O,setIsInitialized:N,showUnavailableLecture:_,setShowUnavailableLecture:k,findStep:V,isStart:C,isEnd:z,isPreview:U,areAllModulesUnavailableWithoutSalesPage:null==E?void 0:E.every(e=>!e.available&&!e.salesPage)}}},77041:(e,t,r)=>{r.d(t,{q:()=>n});let n="/api/membership"}}]);
//# sourceMappingURL=90102-5158e0ea5ff444d9.js.map